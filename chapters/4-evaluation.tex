\chapter{實驗與效能評估}
\label{chapter:evaluation}

為驗證本論文設計之方法，將 free5GC 核心網路移植至 OpenNetVM，使用其所提供之 ABI 能有效提升核心網路之效能，本實驗分別對原生之 free5GC 核心網路部屬於 Ubuntu Linux，與經過 OpenNetVM 移植過後之 free5GC 核心網路一樣部屬於 Ubuntu Linux，分別對其控制端 (control plane) 與用戶端 (user plane) 之效能進行測試，最終比對其結果，以驗證經過 OpenNetVM 移植過後的 free5GC 核心網路確實能有效提供更好的性能。

\textbf{Baseline:} 實驗過程我們會分別對原生之 free5GC 與經過移植至 OpenNetVM 的 LH5GC 進行註冊流程、連線建立流程、與換手流程等三個流程作測試，並比較其控制層的效能分析，另外我們也會建立連線後的用戶端進行頻寬測試，最後我們也會比較基於 Berkeley Socket 與基於 OpenNetVM shared memory 的 SBI 的效能差別。

\section{實驗環境設定}
\label{sec:evaluation_env}

我們所使用的硬體與軟體規格如下：

% This LaTeX table template is generated by emacs 27.2
\begin{table}[h!]
    \centering
    \begin{tabular}{c|l}
        \hline
        CPU & Intel(R) Core(TM) i7-9700 CPU @ 3.00GHz \\
        \hline
        Core No. & 8 \\
        \hline
        NIC & Intel Corporation Ethernet Controller X710/X557-AT 10GBASE-T 1589 \\
        \hline
        OS & centos-release-7-8.2003.0.el7.centos.x86\_64 \\
        \hline
        Kernel & 3.10.0-1127.el7.x86\_64 \\
        \hline
    \end{tabular}
    % [] 放的是顯示在 list of figure 的文字
    % {} 放的是顯示在圖下方的文字
    \caption[系統環境參數]{{\footnotesize 系統環境參數}}
    \label{table:sys_env}
\end{table}

我們的實驗在邏輯上(logically)將系統分為三個部件(component)，邊緣端(edge)、核心網路(core network)、與數據網路(data network)。邊緣端在真實網路下即是手機、基地臺與相關部件，以下會以 UE-RAN simulator 代稱。核心網路如第二章節所講解的，是第五代行動通訊網路中，放在機房(data center)中，負責統籌處理控制端(control plane)與轉發(forward)、封裝(encapsulate)、解封裝(decapsulate)使用者端(user plane)。而數據網路(data network)，則是泛指傳統網路(the Internet)，即為大多數時候，手機使用者想要存取(access)的服務之所在位置。

在務實面(physically)上將系統切分成三個節點，分別模擬使用者端發送、轉發、

為了準確的區分 traffic generating 與 forwarding 的中央處理器(以下簡稱 CPU)使用率，避免單一 CPU 需要同時產生流量與處理流量，我們的測試方法將流量產生器(traffic generator)、核心網路、流量接收者 (traffic receiver) 分別部屬於不同的機器上，讓三者得以完全妥善使用三顆不同之 CPU。

\begin{figure}[htbp]
    \centering
    \begin{tikzpicture}
        \tikzset{vertex/.style = {shape=rectangle,draw,minimum size=1.5em,align=center}}
        \tikzset{edge/.style = {<->,> = latex'}}
        % vertices
        \node[vertex] (a) at (10,) {node 1\\RAN \& UE};
        \node[vertex] (b) at (15,) {node 2\\Core Network};
        \node[vertex] (c) at (20,) {node 3\\Data Network};
        %edges
        \draw[edge] (a) to (b);
        \draw[edge] (b) to (c);
    \end{tikzpicture}
    % [] 放的是顯示在 list of figure 的文字
    % {} 放的是顯示在圖下方的文字
    \caption[硬體架構]{{\footnotesize 硬體架構}}
    \label{fig:hardware_architecture}
\end{figure}

\section{用戶層效能分析}
\label{sec:up_evaluation}

\begin{figure}[htb]
  \centering
  % 圖片的高度與寬度, height 設為 ! 代表由寬度大小等比例縮放
  \includegraphics[height=!,width=1\linewidth,keepaspectratio=true]%
  % 圖片的位置
  {figures/user_plan_performance}
  % [] 放的是顯示在 list of figure 的文字
  % {} 放的是顯示在圖下方的文字
  \caption[用戶層效能]{{\footnotesize 用戶層效能}}
  \label{fig:user_plan_performance}
\end{figure}

\section{控制層效能分析}
\label{sec:cp_evaluation}
